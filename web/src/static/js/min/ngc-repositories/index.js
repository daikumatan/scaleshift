var images=[],conditions={firstLoad:!0,words:"",category:"all"},vue=new Vue({el:"#data",data:{images:[]},methods:{update:function(){var e=[];$.map(images,function(a){(""==conditions.words||app.match([a.namespace,a.name],conditions.words))&&("all"!=conditions.category&&conditions.category!=a.namespace||e.push({code:a.namespace+"/"+a.name,namespace:a.namespace,name:a.name,description:marked(a.description)}))}),e.sort(function(a,e){return group(a.namespace)<group(e.namespace)?-1:group(a.namespace)>group(e.namespace)?1:a.name<e.name?-1:a.name>e.name?1:0}),this.images=e,conditions.firstLoad&&(conditions.firstLoad=!1,""!=conditions.words&&0<e.length&&setTimeout(function(){$("#query-words").blur()},500)),$("#record-count").text(e.length)}}});function group(a){switch(a){case"nvidia":return 1;case"hpc":return 2;case"nvidia-hpcvis":return 3;case"partners":return 4}return 9}function update(){conditions.words=app.singleSpace($("#query-words").val());var a=$("#categories select").val();conditions.category=a||"all",vue.update()}function load(o){API("Repository").getNgcRepositories(function(a,e,t){app.shouldExit(t,a)?auth.exit():(images=t.body,update(),o&&o())})}function loadDetails(n){if(!$(n).attr("data-loaded")){var i=$(n).attr("data-ns"),s=$(n).attr("data-nm");API("Repository").getNgcImages(i,s,function(a,e,t){if(app.shouldExit(t,a))auth.exit();else{var o="";$.map(t.body,function(a){o+='<tr data-id="'+i+"/"+s+":"+a.tag+'">',o+="<td>"+a.tag+"</td>",o+="<td>"+app.comma(a.size,"byte")+"</td>",o+="<td>"+app.date.format(new Date(a.updated))+"</td>",o+='<td><a class="waves-effect waves-light btn blue darken-1">download</a></td>',o+="</tr>"}),$(".row-body tbody",n).html(o),$(".row-body .btn",n).click(function(a){pullImage($(a.target).closest("tr").attr("data-id"))}),$(n).attr("data-loaded","done")}})}}function pullImage(o){var a=new models.ImageName("nvcr.io/"+o);API("Image").postNewImage(a,function(a,e,t){app.shouldExit(t,a)?auth.exit():location.href="/images/?q="+encodeURIComponent(o)})}function setCategories(){var e={};$.map(images,function(a){e[a.namespace]=!0});var t=[];$.map(e,function(a,e){t.push(e)}),t.sort(function(a,e){return a<e?-1:e<a?1:0});var o="";$.map(t,function(a){o+='<option value="'+a+'" class="hidden-xs"'+("nvidia"==a.toLowerCase()?' selected="selected"':"")+">"+a+"</option>"}),o='<option value="all" class="hidden-xs">all</option>'+o;var a=$("#categories select").html(o);a.change(function(){update()}),a.formSelect(),conditions.category=a.val(),update()}$(document).ready(function(){$("#menu-ngc-repositories").addClass("active"),app.query("q")&&$("#query-words").val(app.query("q")).focus(),$(".collapsible").on("shown.bs.collapse",function(a){loadDetails($(a.target).closest("li"))}),load(function(){$("#query-words").keyup(function(){update()}),setCategories(),$("#data").fadeIn()})});