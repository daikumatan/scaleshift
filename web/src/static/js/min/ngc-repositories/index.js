var images=[],conditions={firstLoad:!0,words:"",category:"all"},vue=new Vue({el:"#data",data:{images:[]},methods:{update:function(){var t=[];$.map(images,function(e){(""==conditions.words||app.match([e.namespace,e.name],conditions.words))&&("all"!=conditions.category&&conditions.category!=e.namespace||t.push({code:e.namespace+"/"+e.name,namespace:e.namespace,name:e.name,description:marked(e.description)}))}),t.sort(function(e,t){return group(e.namespace)<group(t.namespace)?-1:group(e.namespace)>group(t.namespace)?1:e.name<t.name?-1:e.name>t.name?1:0}),this.images=t,conditions.firstLoad&&(conditions.firstLoad=!1,""!=conditions.words&&0<t.length&&setTimeout(function(){$("#query-words").blur()},500)),$("#record-count").text(t.length),$(".wait-icon").hide()}}});function group(e){switch(e){case"nvidia":return 1;case"hpc":return 2;case"nvidia-hpcvis":return 3;case"partners":return 4}return 9}function update(){conditions.words=app.singleSpace($("#query-words").val());var e=$("#categories select").val();conditions.category=e||"all",vue.update()}function load(o){API("Repository").getNgcRepositories(function(e,t,a){if(app.shouldExit(a,e))return alert("Something went wrong. Check your configurations!"),void(window.location.href="/settings/");images=a.body,update(),o&&o()})}function loadDetails(n){if(!$(n).attr("data-loaded")){var i=$(n).attr("data-ns"),s=$(n).attr("data-nm");API("Repository").getNgcImages(i,s,function(e,t,a){if(app.shouldExit(a,e))return alert("Something went wrong. Check your configurations!"),void(window.location.href="/settings/");var o="";$.map(a.body,function(e){o+='<tr data-id="'+i+"/"+s+":"+e.tag+'">',o+="<td>"+e.tag+"</td>",o+="<td>"+app.comma(e.size,"byte")+"</td>",o+="<td>"+app.date.format(new Date(e.updated))+"</td>",o+='<td><a class="waves-effect waves-light btn blue darken-1">download</a></td>',o+="</tr>"}),$(n).find(".progress").hide(),$(".row-body tbody",n).html(o),$(".row-body .btn",n).click(function(e){pullImage($(e.target).closest("tr").attr("data-id"))}),$(n).attr("data-loaded","done")})}}function pullImage(o){var e=new models.ImageName("nvcr.io/"+o);API("Image").postNewImage(e,function(e,t,a){if(app.shouldExit(a,e))return alert("Something went wrong. Check your configurations!"),void(window.location.href="/settings/");location.href="/images/?q="+encodeURIComponent(o)})}function setCategories(){var t={};$.map(images,function(e){t[e.namespace]=!0});var a=[];$.map(t,function(e,t){a.push(t)}),a.sort(function(e,t){return e<t?-1:t<e?1:0});var o="";$.map(a,function(e){o+='<option value="'+e+'" class="hidden-xs"'+("nvidia"==e.toLowerCase()?' selected="selected"':"")+">"+e+"</option>"}),o='<option value="all" class="hidden-xs">all</option>'+o;var e=$("#categories select").html(o);e.change(function(){update()}),e.formSelect(),conditions.category=e.val(),update()}$(document).ready(function(){config.get().useNGC?($("#menu-repositories, #menu-ngc-repo").addClass("active"),app.query("q")&&$("#query-words").val(app.query("q")).focus(),$(".collapsible").on("shown.bs.collapse",function(e){loadDetails($(e.target).closest("li"))}),load(function(){$("#query-words").keyup(function(){update()}),setCategories(),$("#data").fadeIn()})):window.location.href="/images/"});