Vue.use(vuelidate.default),API("App").getEndpoints(function(s,e,r){if($.isEmptyObject(s)&&r.body){var a=r.body.docker_registry;"https://registry-1.docker.io"==a&&(a="DockerHub"),$("#endpoint").text(" on "+a)}}),API("App").getConfigurations(function(s,e,r){$.isEmptyObject(s)&&r.body&&(config.set(r.body),config.get().mustSignedIn||(window.location.href="/images/"))});var vue=new Vue({el:".form-signin",data:{username:"",password:"",msgUsername:"",msgPassword:""},validations:{username:{required:validators.required,maxLength:validators.maxLength(256)},password:{required:validators.required,maxLength:validators.maxLength(256)}},methods:{usernameChanged:function(){this.msgUsername=""},passwordChanged:function(){this.msgPassword=""},error:function(s){this.msgUsername=s||"The username or password is incorrect",s||(this.password=""),$("#input-username").focus()},passwordError:function(s){this.msgPassword=s,this.password="",$("#input-password").val("").focus()},submit:function(){if(setTimeout(function(){$(".btn-primary").blur()},500),!$(".btn-primary").attr("disabled"))if($(".btn-primary").attr("disabled","disabled"),$("form p.errors").show(),""==this.password?vue.passwordError("Input your password"):$("#input-password").hasClass("invalid")&&vue.passwordError("Invalid: password"),""==this.username?vue.error("Input your user name"):$("#input-username").hasClass("invalid")&&vue.error("Invalid: Username"),""==this.username||$("#input-username").hasClass("invalid")||""==this.password||$("#input-password").hasClass("invalid"))$(".btn-primary").removeAttr("disabled");else{auth.clear();var s=models.AccountInfo.constructFromObject({docker_username:this.username,docker_password:this.password});API("App").postNewSession(s,function(s,e,r){if($(".btn-primary").removeAttr("disabled"),$.isEmptyObject(s))if(r&&r.body&&r.body.token){var a=config.get();a.docker_username=vue.username,a.use_private_registry="yes",a.usePrivateRegistry=!0,config.set(a),auth.login(r,vue.error,function(){window.location.href="/images/"})}else vue.error("Username or password is invalid.");else vue.error("Username or password is invalid.")})}}}});$(document).ready(function(){$("#input-password").keyup(function(s){13==s.keyCode&&""!=$(this).val()&&vue.submit()}),$("#input-username").focus()});